# システム連携要件 TODO

## 概要
計画書管理システムと他のサブシステムとの連携要件をまとめたTODOリスト。
これらの要件は計画書管理機能の実装後に対応予定。

## 1. 施設検索との連携

### TODO
- [ ] 計画書の内容から検索条件を自動生成する機能
- [ ] サービス種別での一次フィルタリング実装
- [ ] アクセシビリティ要件でのスコアリング機能
- [ ] 地域条件での距離計算アルゴリズム

### 実装詳細
- 計画書で選択されたサービス種別を検索条件に自動反映
- 配慮事項（車椅子対応、送迎など）を施設の条件とマッチング
- 希望地域と施設所在地の距離計算

## 2. 同意管理との連携

### TODO
- [ ] 計画書IDと同意リクエストの紐付け機能
- [ ] バージョン変更時の再同意フロー実装
- [ ] 同意取得状況の計画書画面での表示

### 実装詳細
- 確定版計画書作成時に同意リクエストを自動生成
- 計画書の重要項目変更時に再同意を要求
- 同意ステータスを計画書詳細画面に表示

## 3. 照会管理との連携

### TODO
- [ ] 計画書情報の照会画面での参照機能
- [ ] 施設側への計画書概要の共有機能（同意取得後）
- [ ] 照会結果の計画書への反映

### 実装詳細
- 照会送信時に関連する計画書情報を自動添付
- 同意が得られた範囲で施設に情報開示
- 施設からの受入可否を計画書に記録

## 4. 実装優先順位

1. **Phase 1**: 施設検索との基本連携
   - サービス種別での自動フィルタリング
   - 地域条件の反映

2. **Phase 2**: 同意管理との連携
   - 同意リクエストの自動生成
   - ステータス表示

3. **Phase 3**: 照会管理との連携
   - 計画書情報の共有
   - 照会結果の反映

## 5. 技術的考慮事項

- 各サブシステム間のAPI設計が必要
- データの整合性を保つためのトランザクション管理
- 権限管理とアクセス制御の統一化

## 6. 関連ドキュメント

- `/specs/plan-management/requirements.md` - 計画書管理機能の要件
- `/specs/facility-search/` - 施設検索機能の仕様（未作成）
- `/specs/consent-management/` - 同意管理機能の仕様（未作成）
- `/specs/inquiry-management/` - 照会管理機能の仕様（未作成）